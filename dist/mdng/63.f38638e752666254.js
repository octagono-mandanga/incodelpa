"use strict";(self.webpackChunkmdng=self.webpackChunkmdng||[]).push([[63],{4063:(Z,y,r)=>{r.r(y),r.d(y,{RootLectivosModule:()=>B});var g=r(6814),u=r(4887),e=r(9468),d=r(932),f=r(5154);let _=(()=>{class i{constructor(t){this.crudService=t,this.data=[],this.success=!0,this.loading=!1,this.config={columns:[{key:"nivel.nombre",displayName:"Nivel"},{key:"inicio",displayName:"Fecha Inicio"},{key:"fin",displayName:"Fecha Fin"},{key:"estado",displayName:"Estado"}],actions:{add:"/root/lectivos/add",edit:"/root/lectivos/edit/",view:"/root/lectivos/view/",delete:!0}}}ngOnInit(){this.loading=!0,this.crudService.read("/root/lectivos").subscribe({next:t=>{this.data=t,this.loading=!1},error:t=>{console.error("Error al obtener los lectivos:",t)}})}onBorrar(t){this.loading=!0,this.crudService.delete("/root/lectivos/"+t).subscribe({next:o=>{this.data=this.data.filter(a=>a.id!==t),this.message=o.message,this.success=!1,this.loading=!1},error:o=>{this.message="Error al actualizar "+o,this.success=!1,this.loading=!1}}),setTimeout(()=>{this.message=""},5e3)}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(d.I))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-root-lectivos"]],decls:5,vars:5,consts:[["aria-label","breadcrumb"],[1,"breadcrumb"],["aria-current","page",1,"breadcrumb-item","active"],[3,"data","loading","message","success","config","event"]],template:function(o,a){1&o&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2),e._uU(3,"Lectivos"),e.qZA()()(),e.TgZ(4,"app-datatable",3),e.NdJ("event",function(s){return a.onBorrar(s)}),e.qZA()),2&o&&(e.xp6(4),e.Q6J("data",a.data)("loading",a.loading)("message",a.message)("success",a.success)("config",a.config))},dependencies:[f.n]})}return i})();var m=r(5861);class p{constructor(){this.cursos=[]}setData(n){this.id=n.id,this.inicio=n.inicio,this.fin=n.fin,this.nivel=n.nivel.nombre,this.estado=n.estado,this.orden=n.orden}setCursos(n){n.map(t=>{this.cursos.push(t)})}}var c=r(4036),v=r(4013);let h=(()=>{class i{constructor(t,o){this.crudNivelService=t,this.crudService=o,this.success=!0,this.loading=!1}ngOnInit(){var t=this;return(0,m.Z)(function*(){t.config={columns:[{key:"nivel",displayName:"Nivel",required:!0,type:"select",options:[]},{key:"inicio",displayName:"Fecha Inicio",required:!0,type:"date"},{key:"fin",displayName:"Fecha Fin",required:!0,type:"date"},{key:"estado",displayName:"Estado",type:"select",options:[{value:"activo",displayValue:"Activo"},{value:"inactivo",displayValue:"Inactivo"}],required:!0}],actions:{}};try{const a=(yield(0,c.z)(t.crudNivelService.read("/root/niveles"))).filter(s=>"activo"===s.estado).map(s=>({value:s.id.toString(),displayValue:s.nombre})),l=t.config.columns.find(s=>"nivel"===s.key);l&&(l.options=a)}catch(o){console.error("Error:",o)}})()}onAgregar(t){this.loading=!0,this.crudService.create(t,"/root/lectivos").subscribe({next:o=>{this.data=new p,this.message=o.message,this.success=!0,this.loading=!1},error:o=>{this.message="Error al crear el lectivo : "+o,this.success=!0,this.loading=!1}}),setTimeout(()=>{this.message=""},5e3)}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(d.I),e.Y36(d.I))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-root-lectivos-add"]],decls:8,vars:4,consts:[["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/root/lectivos"],["aria-current","page",1,"breadcrumb-item","active"],[3,"loading","message","success","config","event"]],template:function(o,a){1&o&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Lectivos"),e.qZA()(),e.TgZ(5,"li",4),e._uU(6,"Nuevo"),e.qZA()()(),e.TgZ(7,"app-formulario",5),e.NdJ("event",function(s){return a.onAgregar(s)}),e.qZA()),2&o&&(e.xp6(7),e.Q6J("loading",a.loading)("message",a.message)("success",a.success)("config",a.config))},dependencies:[u.rH,v.o]})}return i})(),x=(()=>{class i{constructor(t,o,a){this.route=t,this.crudService=o,this.crudNivelService=a,this.success=!0,this.loading=!1}ngOnInit(){var t=this;return(0,m.Z)(function*(){t.id=t.route.snapshot.params.id,t.config={columns:[{key:"nivel",displayName:"Nivel",required:!0,type:"select",options:[]},{key:"inicio",displayName:"Fecha Inicio",required:!0,type:"date"},{key:"fin",displayName:"Fecha Fin",required:!0,type:"date"},{key:"estado",displayName:"Estado",type:"select",options:[{value:"activo",displayValue:"Activo"},{value:"inactivo",displayValue:"Inactivo"}],required:!0}],actions:{}};try{t.loading=!0;const o=yield(0,c.z)(t.crudNivelService.read("/root/niveles"));t.crudService.read("/root/lectivos/"+t.id).subscribe({next:s=>{t.data=s.data,t.data.nivel=s.data.nivel.id,t.loading=!1},error:s=>{t.message="Error al editar el lectivo : "+s,t.success=!1,t.loading=!1}});const a=o.filter(s=>"activo"===s.estado).map(s=>({value:s.id.toString(),displayValue:s.nombre})),l=t.config.columns.find(s=>"nivel"===s.key);l&&(l.options=a)}catch(o){console.error("Error:",o)}})()}onEditar(t){this.loading=!0,this.crudService.update(t,"/root/lectivos/"+this.id).subscribe({next:o=>{this.data=o.data,this.message=o.message,this.success=!0,this.loading=!1},error:o=>{this.loading=!1,this.message="Error al actualizar "+o,this.success=!1}}),setTimeout(()=>{this.message=""},5e3)}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(u.gz),e.Y36(d.I),e.Y36(d.I))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-root-lectivos-edit"]],decls:8,vars:5,consts:[["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/root/lectivos"],["aria-current","page",1,"breadcrumb-item","active"],[3,"loading","message","success","config","entityData","event"]],template:function(o,a){1&o&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Lectivos"),e.qZA()(),e.TgZ(5,"li",4),e._uU(6,"Nuevo"),e.qZA()()(),e.TgZ(7,"app-formulario",5),e.NdJ("event",function(s){return a.onEditar(s)}),e.qZA()),2&o&&(e.xp6(7),e.Q6J("loading",a.loading)("message",a.message)("success",a.success)("config",a.config)("entityData",a.data))},dependencies:[u.rH,v.o]})}return i})();var b=r(6825),T=r(3630),w=r(8788),A=r(6688);function N(i,n){if(1&i&&(e.TgZ(0,"li",7),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.data.nivel," ")}}function I(i,n){if(1&i&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11),e._UZ(4,"app-loading",12),e.TgZ(5,"h4",13),e._uU(6),e.qZA()()()()()),2&i){const t=e.oxw();e.xp6(6),e.hij(" Cargando ",t.msg,"... ")}}function C(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.onCerrar())}),e._uU(1," Cerrar Lectivo "),e.qZA()}2&i&&e.Q6J("@fadeInOut",void 0)}function L(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.onConfirmar())}),e._uU(1," Confirmar "),e.qZA()}2&i&&e.Q6J("@fadeInOut",void 0)}function E(i,n){1&i&&(e.TgZ(0,"button",28),e._uU(1," Procesando... "),e.qZA()),2&i&&e.Q6J("@fadeInOut",void 0)}function R(i,n){if(1&i&&(e.TgZ(0,"div",22),e.YNc(1,C,2,1,"button",23),e.YNc(2,L,2,1,"button",24),e.YNc(3,E,2,1,"button",25),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf","cerrar"===t.actionState),e.xp6(1),e.Q6J("ngIf","confirmar"===t.actionState),e.xp6(1),e.Q6J("ngIf","procesando"===t.actionState)}}function S(i,n){if(1&i&&e._UZ(0,"i",33),2&i){const t=e.oxw().$implicit;e.Q6J("title",t.encabezado.nombre_alumno)}}function U(i,n){if(1&i&&e._UZ(0,"i",34),2&i){const t=e.oxw().$implicit;e.Q6J("title",t.encabezado.nombre_alumno)}}function J(i,n){if(1&i&&e._UZ(0,"i",35),2&i){const t=e.oxw().$implicit;e.Q6J("title",t.encabezado.nombre_alumno)}}function V(i,n){if(1&i&&(e.TgZ(0,"span"),e.YNc(1,S,1,1,"i",30),e.YNc(2,U,1,1,"i",31),e.YNc(3,J,1,1,"i",32),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf",1===t.promocion.id),e.xp6(1),e.Q6J("ngIf",2===t.promocion.id),e.xp6(1),e.Q6J("ngIf",3===t.promocion.id)}}function k(i,n){if(1&i&&(e.TgZ(0,"div",14)(1,"div",29),e.YNc(2,V,4,3,"span",21),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.boletines)}}function q(i,n){1&i&&(e.TgZ(0,"div",36),e._UZ(1,"div",37),e.qZA())}function Q(i,n){if(1&i&&(e.TgZ(0,"div",38)(1,"div",39)(2,"div")(3,"small",40),e._uU(4," Curso: "),e.TgZ(5,"span",41),e._uU(6),e.qZA()()(),e.TgZ(7,"div",42)(8,"small")(9,"span",43),e._uU(10),e.qZA()()()(),e.TgZ(11,"div",44),e._UZ(12,"div",45),e.qZA(),e.TgZ(13,"div",46)(14,"div")(15,"small",43),e._uU(16),e.qZA()(),e.TgZ(17,"div",42)(18,"small",43),e._uU(19),e.qZA()()()()),2&i){const t=e.oxw(2);e.xp6(6),e.hij(" ",t.curso.nombre," "),e.xp6(4),e.AsE(" ",t.cont," de ",t.data.cursos.length," "),e.xp6(2),e.Akn("width: "+t.progreso+"%"),e.xp6(4),e.HOy(" Procesando a ",t.alumno.primer_apellido," ",t.alumno.segundo_apellido," ",t.alumno.primer_nombre," ",t.alumno.segundo_nombre," "),e.xp6(3),e.AsE(" ",t.processedEstudiantes," de ",t.totalEstudiantes," ")}}function Y(i,n){if(1&i&&(e.ynx(0),e.TgZ(1,"div",47)(2,"div",48)(3,"h3",49),e._uU(4),e.qZA(),e.TgZ(5,"p",50),e._uU(6),e.qZA()(),e.TgZ(7,"div",51)(8,"p",52)(9,"strong"),e._uU(10,"Materias:"),e.qZA(),e._uU(11),e.qZA(),e.TgZ(12,"p",52)(13,"strong"),e._uU(14,"Director:"),e.qZA(),e._uU(15),e.qZA(),e.TgZ(16,"p",53)(17,"strong"),e._uU(18,"Alumnos:"),e.qZA(),e._uU(19),e.qZA()()(),e.BQk()),2&i){const t=n.$implicit;e.xp6(4),e.Oqu(t.nombre),e.xp6(2),e.Oqu(t.grado.nombre),e.xp6(5),e.hij(" ",t.asignaciones.length,""),e.xp6(4),e.hij(" ",t.director?t.director.primer_nombre+" "+t.director.primer_apellido:"No asignado",""),e.xp6(4),e.hij(" ",t.matriculas.length,"")}}function F(i,n){if(1&i&&(e.TgZ(0,"div",14)(1,"div",15),e._UZ(2,"app-entity-display",16),e.YNc(3,R,4,3,"div",17),e.YNc(4,k,3,1,"div",6),e.qZA(),e.TgZ(5,"div",18),e.YNc(6,q,2,0,"div",19),e.YNc(7,Q,20,11,"div",20),e.YNc(8,Y,20,5,"ng-container",21),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("config",t.config)("entityData",t.data),e.xp6(1),e.Q6J("ngIf","activo"==t.data.estado),e.xp6(1),e.Q6J("ngIf","activo"==t.data.estado),e.xp6(2),e.Q6J("ngIf",t.progress),e.xp6(1),e.Q6J("ngIf",t.curso),e.xp6(1),e.Q6J("ngForOf",t.data.cursos)}}const O=[{path:"",component:_},{path:"add",component:h},{path:"edit/:id",component:x},{path:"view/:id",component:(()=>{class i{constructor(t,o,a,l,s){this.activeRoute=t,this.router=o,this.crudService=a,this.crudAnyService=l,this.crudMatriculaService=s,this.success=!0,this.loading=!1,this.progress=!1,this.progreso=0,this.cont=0,this.totalEstudiantes=0,this.processedEstudiantes=0,this.cursoalumnos=[],this.data=new p,this.boletin=new T.j,this.boletines=[],this.actionState="cerrar"}ngOnInit(){var t=this;return(0,m.Z)(function*(){t.loading=!0,t.msg="Lectivo",t.id=t.activeRoute.snapshot.params.id,t.config={columns:[{key:"nivel",displayName:"Nivel"},{key:"inicio",displayName:"Inicio"},{key:"fin",displayName:"Fin"},{key:"estado",displayName:"Estado"},{key:"orden",displayName:"Orden"}],actions:{}},yield t.crudService.read("/root/cursos/lectivo/"+t.id).subscribe({next:o=>{t.data.setData(o.lectivo),t.data.setCursos(o.data),t.loading=!1},error:o=>{t.message="Error al cargar el area : "+o,t.success=!1,t.loading=!1,t.onMessage()}})})()}onMessage(){setTimeout(()=>{this.message=""},5e3)}onCerrar(){this.actionState="confirmar"}onConfirmar(){var t=this;return(0,m.Z)(function*(){t.actionState="procesando",t.progreso=0,t.totalEstudiantes=0;for(const a of t.data.cursos)t.totalEstudiantes+=a.matriculas.length;t.processedEstudiantes=0;for(const a of t.data.cursos){t.cursoalumnos=[],t.curso=a,t.cont++;for(const l of a.matriculas){t.cursoalumnos.push(l.alumno),t.alumno=l.alumno,t.processedEstudiantes++,t.progreso=t.processedEstudiantes/t.totalEstudiantes*100,t.boletin=new T.j;const s=yield(0,c.z)(t.crudMatriculaService.read("/root/matricula/"+l.id));if(yield t.boletin.setBoletin(a,s.data),yield t.boletin.setPromocion(s.data),2===t.boletin.promocion.id){const j=yield(0,c.z)(t.crudMatriculaService.read(`/root/habilitacion/${l.id}`));yield t.boletin.verificarHabilitacion(j.data)}yield(0,c.z)(t.crudMatriculaService.read("/root/matricula/cerrar/"+l.id+"/"+t.boletin.promocion.id)),t.boletines.push(t.boletin)}yield(0,c.z)(t.crudAnyService.read(`/root/cursos/inactivar/${a.id}`))}"anterior"===(yield(0,c.z)(t.crudAnyService.read(`/root/lectivos/inactivar/${t.id}`))).data.estado&&t.router.navigate(["/root/lectivos/"]),t.curso=null,t.actionState="cerrar"})()}delay(t){return new Promise(o=>setTimeout(o,t))}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(u.gz),e.Y36(u.F0),e.Y36(d.I),e.Y36(d.I),e.Y36(d.I))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-root-lectivos-view"]],decls:8,vars:3,consts:[["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/root/lectivos"],["class","breadcrumb-item active","aria-current","page",4,"ngIf"],["class","card",4,"ngIf"],["class","row",4,"ngIf"],["aria-current","page",1,"breadcrumb-item","active"],[1,"card"],[1,"card-body"],[1,"container","mt-3"],[1,"d-flex","justify-content-center"],["size","30px"],[1,"ms-2","text-secondary"],[1,"row"],[1,"col-3"],[3,"config","entityData"],["class","d-grid gap-2 mt-2",4,"ngIf"],[1,"col-9"],["class","progress mb-2","role","progressbar","aria-valuenow","50","aria-valuemin","0","aria-valuemax","100","style","height: 5px",4,"ngIf"],["class","card p-3 mb-2",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"d-grid","gap-2","mt-2"],["class","btn btn-secondary","type","button",3,"click",4,"ngIf"],["class","btn btn-warning","type","button",3,"click",4,"ngIf"],["class","btn btn-success","type","button","disabled","",4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-warning",3,"click"],["type","button","disabled","",1,"btn","btn-success"],[1,"d-flex","flex-wrap"],["class","fa-solid fa-circle-check text-success me-1",3,"title",4,"ngIf"],["class","fa-solid fa-circle-exclamation text-warning me-1",3,"title",4,"ngIf"],["class","fa-solid fa-circle-xmark text-danger me-1",3,"title",4,"ngIf"],[1,"fa-solid","fa-circle-check","text-success","me-1",3,"title"],[1,"fa-solid","fa-circle-exclamation","text-warning","me-1",3,"title"],[1,"fa-solid","fa-circle-xmark","text-danger","me-1",3,"title"],["role","progressbar","aria-valuenow","50","aria-valuemin","0","aria-valuemax","100",1,"progress","mb-2",2,"height","5px"],[1,"progress-bar","progress-bar-striped","progress-bar-animated",2,"width","50%"],[1,"card","p-3","mb-2"],[1,"d-flex","mb-1"],[1,"fw-bold"],[1,"text-primary"],[1,"ms-auto"],[1,"text-secondary"],["role","progressbar","aria-valuenow","50","aria-valuemin","0","aria-valuemax","100",1,"progress",2,"height","10px"],[1,"progress-bar","progress-bar-striped","progress-bar-animated"],[1,"d-flex","mt-1"],[1,"d-flex","p-3","shadow-sm","bg-light","rounded","mb-2"],[1,"flex-shrink-0"],[1,"text-primary","fw-bold","text-center","mb-1"],[1,"text-muted","text-center","mb-0"],[1,"flex-grow-1","ms-4","text-start"],[1,"mb-1"],[1,"mb-0"]],template:function(o,a){1&o&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Lectivos"),e.qZA()(),e.YNc(5,N,2,1,"li",4),e.qZA()(),e.YNc(6,I,7,1,"div",5),e.YNc(7,F,9,7,"div",6)),2&o&&(e.xp6(5),e.Q6J("ngIf",!a.loading),e.xp6(1),e.Q6J("ngIf",a.loading),e.xp6(1),e.Q6J("ngIf",!a.loading))},dependencies:[g.sg,g.O5,u.rH,w.D,A.N],data:{animation:[(0,b.X$)("fadeInOut",[(0,b.eR)(":enter",[(0,b.oB)({opacity:0,transform:"scale(0.8)"}),(0,b.jt)("300ms ease-out",(0,b.oB)({opacity:1,transform:"scale(1)"}))]),(0,b.eR)(":leave",[(0,b.jt)("300ms ease-in",(0,b.oB)({opacity:0,transform:"scale(0.8)"}))])])]}})}return i})()}];let z=(()=>{class i{static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275mod=e.oAB({type:i});static#i=this.\u0275inj=e.cJS({imports:[u.Bz.forChild(O),u.Bz]})}return i})();var M=r(6208);let B=(()=>{class i{static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275mod=e.oAB({type:i});static#i=this.\u0275inj=e.cJS({imports:[g.ez,z,M.m]})}return i})()},4036:(Z,y,r)=>{r.d(y,{z:()=>e});var g=r(6973),u=r(305);function e(d,f){const _="object"==typeof f;return new Promise((m,p)=>{const c=new u.Hp({next:v=>{m(v),c.unsubscribe()},error:p,complete:()=>{_?m(f.defaultValue):p(new g.K)}});d.subscribe(c)})}},5861:(Z,y,r)=>{function g(e,d,f,_,m,p,c){try{var v=e[p](c),h=v.value}catch(x){return void f(x)}v.done?d(h):Promise.resolve(h).then(_,m)}function u(e){return function(){var d=this,f=arguments;return new Promise(function(_,m){var p=e.apply(d,f);function c(h){g(p,_,m,c,v,"next",h)}function v(h){g(p,_,m,c,v,"throw",h)}c(void 0)})}}r.d(y,{Z:()=>u})}}]);