"use strict";(self.webpackChunkmdng=self.webpackChunkmdng||[]).push([[664],{434:(b,y,r)=>{r.r(y),r.d(y,{RootPeriodosModule:()=>A});var f=r(6814),p=r(4887),e=r(9468),n=r(932),m=r(5154);let v=(()=>{class a{constructor(t){this.crudService=t,this.data=[],this.success=!0,this.loading=!1,this.config={columns:[{key:"lectivo.nivel.nombre",displayName:"Lectivo"},{key:"nombre",displayName:"Nombre"},{key:"inicio",displayName:"Fecha Inicio"},{key:"fin",displayName:"Fecha Fin"},{key:"porcentaje",displayName:"Porcentaje"},{key:"estado",displayName:"Estado"}],actions:{add:"/root/periodos/add",edit:"/root/periodos/edit/",delete:!0}}}ngOnInit(){this.loading=!0,this.crudService.read("/root/periodos").subscribe({next:t=>{this.data=t,this.loading=!1},error:t=>{console.error("Error al obtener los periodos:",t)}})}onBorrar(t){this.loading=!0,this.crudService.delete("/root/periodos/"+t).subscribe({next:o=>{this.data=this.data.filter(s=>s.id!==t),this.message=o.message,this.success=!1,this.loading=!1},error:o=>{this.message="Error al actualizar "+o,this.success=!1,this.loading=!1}}),setTimeout(()=>{this.message=""},5e3)}static#e=this.\u0275fac=function(o){return new(o||a)(e.Y36(n.I))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-root-periodos"]],decls:5,vars:5,consts:[["aria-label","breadcrumb"],[1,"breadcrumb"],["aria-current","page",1,"breadcrumb-item","active"],[3,"data","loading","message","success","config","event"]],template:function(o,s){1&o&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2),e._uU(3,"Periodos"),e.qZA()()(),e.TgZ(4,"app-datatable",3),e.NdJ("event",function(i){return s.onBorrar(i)}),e.qZA()),2&o&&(e.xp6(4),e.Q6J("data",s.data)("loading",s.loading)("message",s.message)("success",s.success)("config",s.config))},dependencies:[m.n]})}return a})();var c=r(5861),d=r(4036),l=r(2721),u=r(4013);const E=[{path:"",component:v},{path:"add",component:(()=>{class a{constructor(t,o){this.crudLectivoService=t,this.crudService=o,this.success=!0,this.loading=!1}ngOnInit(){var t=this;return(0,c.Z)(function*(){t.config={columns:[{key:"lectivo",displayName:"Lectivo",required:!0,type:"select",options:[]},{key:"nombre",displayName:"Nombre",type:"select",options:[{value:"primero",displayValue:"Primero"},{value:"segundo",displayValue:"Segundo"},{value:"tercero",displayValue:"Tercero"},{value:"cuarto",displayValue:"Cuarto"}],required:!0},{key:"inicio",displayName:"Fecha Inicio",required:!0,type:"date"},{key:"fin",displayName:"Fecha Fin",required:!0,type:"date"},{key:"porcentaje",displayName:"Porcentaje",required:!0,type:"number"},{key:"estado",displayName:"Estado",type:"select",options:[{value:"activo",displayValue:"Activo"},{value:"inactivo",displayValue:"Inactivo"}],required:!0}],actions:{}};try{const s=(yield(0,d.z)(t.crudLectivoService.read("/root/lectivos"))).filter(i=>"activo"===i.estado).map(i=>({value:i.id.toString(),displayValue:i.nivel.nombre+" ("+i.inicio+" "+i.fin+")"})),g=t.config.columns.find(i=>"lectivo"===i.key);g&&(g.options=s)}catch(o){console.error("Error:",o)}})()}onAgregar(t){this.loading=!0,this.crudService.create(t,"/root/periodos").subscribe({next:o=>{this.data=new l.p,this.message=o.message,this.success=!0,this.loading=!1},error:o=>{this.message="Error al crear el periodo : "+o,this.success=!1,this.loading=!1}}),setTimeout(()=>{this.message=""},5e3)}static#e=this.\u0275fac=function(o){return new(o||a)(e.Y36(n.I),e.Y36(n.I))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-root-periodos-add"]],decls:8,vars:4,consts:[["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/root/periodos"],["aria-current","page",1,"breadcrumb-item","active"],[3,"loading","message","success","config","event"]],template:function(o,s){1&o&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Periodos"),e.qZA()(),e.TgZ(5,"li",4),e._uU(6,"Nuevo"),e.qZA()()(),e.TgZ(7,"app-formulario",5),e.NdJ("event",function(i){return s.onAgregar(i)}),e.qZA()),2&o&&(e.xp6(7),e.Q6J("loading",s.loading)("message",s.message)("success",s.success)("config",s.config))},dependencies:[p.rH,u.o]})}return a})()},{path:"edit/:id",component:(()=>{class a{constructor(t,o,s){this.route=t,this.crudService=o,this.crudLectivoService=s,this.success=!0,this.loading=!1}ngOnInit(){var t=this;return(0,c.Z)(function*(){t.id=t.route.snapshot.params.id,t.config={columns:[{key:"lectivo",displayName:"Lectivo",required:!0,type:"select",options:[]},{key:"nombre",displayName:"Nombre",type:"select",options:[{value:"primero",displayValue:"Primero"},{value:"segundo",displayValue:"Segundo"},{value:"tercero",displayValue:"Tercero"},{value:"cuarto",displayValue:"Cuarto"}],required:!0},{key:"inicio",displayName:"Fecha Inicio",required:!0,type:"date"},{key:"fin",displayName:"Fecha Fin",required:!0,type:"date"},{key:"porcentaje",displayName:"Porcentaje",required:!0,type:"number"},{key:"estado",displayName:"Estado",type:"select",options:[{value:"activo",displayValue:"Activo"},{value:"inactivo",displayValue:"Inactivo"}],required:!0}],actions:{}};try{t.loading=!0;const o=yield(0,d.z)(t.crudLectivoService.read("/root/lectivos"));t.crudService.read("/root/periodos/"+t.id).subscribe({next:i=>{t.data=i.data,t.data.lectivo=i.data.lectivo.id,t.loading=!1},error:i=>{t.message="Error al editar el lectivo : "+i,t.success=!1,t.loading=!1}});const s=o.filter(i=>"activo"===i.estado).map(i=>({value:i.id.toString(),displayValue:i.nivel.nombre+" ("+i.inicio+" "+i.fin+")"})),g=t.config.columns.find(i=>"lectivo"===i.key);g&&(g.options=s)}catch(o){console.error("Error:",o)}})()}onEditar(t){this.loading=!0,this.crudService.update(t,"/root/periodos/"+this.id).subscribe({next:o=>{this.data=o.data,this.message=o.message,this.success=!0,this.loading=!1},error:o=>{this.loading=!1,this.message="Error al actualizar "+o,this.success=!1}}),setTimeout(()=>{this.message=""},5e3)}static#e=this.\u0275fac=function(o){return new(o||a)(e.Y36(p.gz),e.Y36(n.I),e.Y36(n.I))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-root-periodos-edit"]],decls:8,vars:5,consts:[["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/root/periodos"],["aria-current","page",1,"breadcrumb-item","active"],[3,"loading","message","success","config","entityData","event"]],template:function(o,s){1&o&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Periodos"),e.qZA()(),e.TgZ(5,"li",4),e._uU(6,"Editar"),e.qZA()()(),e.TgZ(7,"app-formulario",5),e.NdJ("event",function(i){return s.onEditar(i)}),e.qZA()),2&o&&(e.xp6(7),e.Q6J("loading",s.loading)("message",s.message)("success",s.success)("config",s.config)("entityData",s.data))},dependencies:[p.rH,u.o]})}return a})()}];let N=(()=>{class a{static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275mod=e.oAB({type:a});static#o=this.\u0275inj=e.cJS({imports:[p.Bz.forChild(E),p.Bz]})}return a})();var T=r(6208);let A=(()=>{class a{static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275mod=e.oAB({type:a});static#o=this.\u0275inj=e.cJS({imports:[f.ez,N,T.m]})}return a})()},4036:(b,y,r)=>{r.d(y,{z:()=>e});var f=r(6973),p=r(305);function e(n,m){const v="object"==typeof m;return new Promise((c,d)=>{const l=new p.Hp({next:u=>{c(u),l.unsubscribe()},error:d,complete:()=>{v?c(m.defaultValue):d(new f.K)}});n.subscribe(l)})}},5861:(b,y,r)=>{function f(e,n,m,v,c,d,l){try{var u=e[d](l),h=u.value}catch(P){return void m(P)}u.done?n(h):Promise.resolve(h).then(v,c)}function p(e){return function(){var n=this,m=arguments;return new Promise(function(v,c){var d=e.apply(n,m);function l(h){f(d,v,c,l,u,"next",h)}function u(h){f(d,v,c,l,u,"throw",h)}l(void 0)})}}r.d(y,{Z:()=>p})}}]);