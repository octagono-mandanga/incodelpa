<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a routerLink="/root/lectivos">Lectivos</a></li>
    <li class="breadcrumb-item active" *ngIf="!loading" aria-current="page">
      {{data.nivel}}
    </li>
  </ol>
</nav>
<div class="card" *ngIf="loading">
  <div class="card-body">
    <div class="container mt-3">
      <div class="d-flex justify-content-center">
        <app-loading size="30px"></app-loading>
        <h4 class="ms-2 text-secondary">
          Cargando {{msg}}...
        </h4>
      </div>
    </div>
  </div>
</div>
<div class="row" *ngIf="!loading">
  <div class="col-3">
    <app-entity-display [config]="config" [entityData]="data"></app-entity-display>
    <div class="d-grid gap-2 mt-2" *ngIf="data.estado=='activo'">
      <!-- Botón Cerrar Lectivo -->
        <button
          *ngIf="actionState === 'cerrar'"
          (click)="onCerrar()"
          class="btn btn-secondary"
          type="button"
          [@fadeInOut]>
          Cerrar Lectivo
        </button>

        <!-- Botón Confirmar -->
        <button
          *ngIf="actionState === 'confirmar'"
          (click)="onConfirmar()"
          class="btn btn-warning"
          type="button"
          [@fadeInOut]>
          Confirmar
        </button>

        <!-- Botón Procesando (deshabilitado) -->
        <button
          *ngIf="actionState === 'procesando'"
          class="btn btn-success"
          type="button"
          [@fadeInOut]
          disabled>
          Procesando...
        </button>
     </div>
     <div class="row" *ngIf="data.estado=='activo'">
       <div class="d-flex flex-wrap">
         <span *ngFor="let item of boletines">
            <i *ngIf="item.promocion.id===1" class="fa-solid fa-circle-check text-success me-1" [title]="item.encabezado.nombre_alumno"></i>
            <i *ngIf="item.promocion.id===2" class="fa-solid fa-circle-exclamation text-warning me-1" [title]="item.encabezado.nombre_alumno"></i>
            <i *ngIf="item.promocion.id===3" class="fa-solid fa-circle-xmark text-danger me-1" [title]="item.encabezado.nombre_alumno"></i>
         </span>
       </div>
     </div>
  </div>
  <div class="col-9">
        <div *ngIf="progress" class="progress mb-2" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="height: 5px">
          <div class="progress-bar progress-bar-striped progress-bar-animated" style="width: 50%"></div>
        </div>
        <div class="card p-3 mb-2" *ngIf="curso">
            <div class="d-flex mb-1">
              <div>
                <small class="fw-bold">
                  Curso:
                  <span class="text-primary">
                    {{ curso.nombre }}
                  </span>
                </small>
              </div>
              <div class="ms-auto">
                <small>
                  <span class="text-secondary">
                    {{cont}} de {{ data.cursos.length }}
                  </span>
                </small>
              </div>
            </div>
            <div class="progress" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="height: 10px">
              <div class="progress-bar progress-bar-striped progress-bar-animated" [style]="'width: '+progreso+'%'"></div>
            </div>


            <div class="d-flex mt-1">
              <div>
                <small class="text-secondary">
                  Procesando a {{alumno.primer_apellido }} {{alumno.segundo_apellido }} {{alumno.primer_nombre }} {{alumno.segundo_nombre }}
                </small>
              </div>
              <div class="ms-auto">
                <small class="text-secondary">
                    {{processedEstudiantes}} de {{totalEstudiantes}}
                </small>
              </div>
            </div>

        </div>
        <ng-container *ngFor="let curso of data.cursos; let i = index">
          <div class="d-flex p-3 shadow-sm bg-light rounded mb-2">
            <!-- Izquierda: Nombre y Grado -->
            <div class="flex-shrink-0">
                <h3 class="text-primary fw-bold text-center mb-1">{{ curso.nombre }}</h3>
                <p class="text-muted  text-center mb-0">{{ curso.grado.nombre }}</p>
            </div>

            <!-- Derecha: Datos del curso -->
            <div class="flex-grow-1 ms-4 text-start">
                <p class="mb-1"><strong>Materias:</strong> {{ curso.asignaciones.length }}</p>
                <p class="mb-1"><strong>Director:</strong> {{ curso.director ? curso.director.primer_nombre + ' ' + curso.director.primer_apellido : 'No asignado' }}</p>
                <p class="mb-0"><strong>Alumnos:</strong> {{ curso.matriculas.length }}</p>
            </div>
          </div>

        </ng-container>





  </div>
</div>


